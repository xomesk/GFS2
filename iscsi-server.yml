---
  - name: update yum 
    become: yes
    hosts: all
    tasks: 
      - name: yum update 
        yum:
          name: '*'
          state: latest
          update_cache: yes
        name: install ansible galaxy
        yum:
          name: 
            - epel-release
            - ansible 
              #     - name: install ansible galaxy
              #       shell: ansible-galaxy install OndrejHome.targetcli

  - name: install iscsi server
    become: yes
    hosts: all 
    roles:
      - { role: OndrejHome.targetcli }
    vars:
      iscsi_targets:
        - wwn: 'iqn.1994-05.com.redhat:target'
          disks:
            - path: '/dev/vdb'
              name: 'data'
              type: 'block'
          initiators:
            - 'iqn.1994-05.com.redhat:client1'
            - 'iqn.1994-05.com.redhat:client2'
            - 'iqn.1994-05.com.redhat:client3'
